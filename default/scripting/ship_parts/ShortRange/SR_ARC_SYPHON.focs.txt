Part
    name = "SR_ARC_SYPHON"
    description = "SR_ARC_SYPHON_DESC"
    class = ShortRange
    damage = 4
    shots = 0
    mountableSlotTypes = Core
    buildcost = 40 * [[FLEET_UPKEEP_MULTIPLICATOR]] * [[SHIP_PART_COST_MULTIPLIER]]
    buildtime = 1
    tags = [ "PEDIA_PC_DIRECT_WEAPON" ]
    location = And [
        Planet
        OwnedBy empire = Source.Owner
    ]
    effectsgroups = [
        // syphon all arcs in the same fleet
        // once: first collect arc disruptor shot count as a special on the lowest syphon ship id
        EffectsGroup
            scope = Source
            activation = And [
                Source
                Object id = Statistic Min value = LocalCandidate.ID condition = And [
                    Ship
                    ContainedBy condition = Object id = Source.FleetID
                    DesignHasPart low = 1 high = 999 name = "SR_ARC_SYPHON"
                ]
            ]
            stackinggroup = "SR_ARC_SYPHON_CHARGE_STACK"
            effects = SetSpecialCapacity
                name = "SR_ARC_SYPHON_CHARGE"
                capacity = Statistic Sum value = ((ShipPartMeter part = "SR_ARC_DISRUPTOR" meter = SecondaryStat object = LocalCandidate.ID) * (PartsInShipDesign name = "SR_ARC_DISRUPTOR" design = LocalCandidate.DesignID))
                           condition = And [
                               Ship
                               ContainedBy condition = Object id = Source.FleetID
                               DesignHasPart low = 1 high = 999 name = "SR_ARC_DISRUPTOR"
                ]

        // TODO distribute to syphons, at a later priority

        // TODO timing; e.g. with the policies
        // then nullify all capacity of arc disruptors
        EffectsGroup
            scope = And [
                Ship
                ContainedBy condition = Object id = Source.FleetID
            ]
            activation = And [
                Object id = Source.FleetID
                Fleet
                Contains condition = And [
                    Ship
                    DesignHasPart low = 1 high = 999 name = "SR_ARC_DISRUPTOR"
                ]
            ]
            stackinggroup = "SR_ARC_SYPHON_STACK"
            effects = SetSecondaryStat partname = "SR_ARC_DISRUPTOR" value = 0
    ]
    icon = "icons/ship_parts/pulse-laser.png"

#include "shortrange.macros"

#include "/scripting/macros/upkeep.macros"
#include "/scripting/ship_parts/targeting.macros"
